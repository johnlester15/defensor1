<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Image Cloud</title>
    <style>
        :root {
            --color-canvas-default: #0d1117;
            --color-canvas-subtle: #161b22;
            --color-border-default: #30363d;
            --color-accent-fg: #2f81f7;
            --color-btn-bg: #238636;
            --color-btn-hover: #2ea043;
            --color-fg-default: #c9d1d9;
            --color-fg-muted: #8b949e;
            --color-attention-subtle: rgba(187,128,9,0.15);
        }

        body {
            background-color: var(--color-canvas-default);
            color: var(--color-fg-default);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            margin: 0;
            line-height: 1.5;
        }

        /* Top Navigation Bar */
        nav {
            background-color: #010409;
            border-bottom: 1px solid var(--color-border-default);
            padding: 12px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-left { display: flex; align-items: center; gap: 16px; }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        /* Repo Header Section */
        .repo-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .repo-path { font-size: 20px; display: flex; align-items: center; gap: 8px; }
        .repo-path a { color: var(--color-accent-fg); text-decoration: none; font-weight: 600; }
        .repo-path span { color: var(--color-fg-muted); }

        .repo-badge {
            font-size: 12px;
            padding: 2px 10px;
            border: 1px solid var(--color-border-default);
            border-radius: 20px;
            color: var(--color-fg-muted);
        }

        /* Tabs Mockup */
        .tabs {
            display: flex;
            gap: 8px;
            border-bottom: 1px solid var(--color-border-default);
            margin-bottom: 24px;
        }

        .tab {
            padding: 8px 16px;
            font-size: 14px;
            color: var(--color-fg-default);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 6px;
            border-bottom: 2px solid transparent;
        }

        .tab.active { border-bottom: 2px solid #f78166; font-weight: 600; }

        /* Settings/Input Box */
        .box {
            background-color: var(--color-canvas-subtle);
            border: 1px solid var(--color-border-default);
            border-radius: 6px;
            margin-bottom: 24px;
            overflow: hidden;
        }

        .box-header {
            padding: 16px;
            background-color: rgba(110, 118, 129, 0.1);
            border-bottom: 1px solid var(--color-border-default);
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .box-body { padding: 16px; }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 12px;
        }

        input[type="text"], input[type="password"] {
            background-color: var(--color-canvas-default);
            border: 1px solid var(--color-border-default);
            border-radius: 6px;
            color: var(--color-fg-default);
            padding: 5px 12px;
            font-size: 14px;
            width: calc(100% - 26px);
        }

        input:focus {
            border-color: var(--color-accent-fg);
            outline: none;
            box-shadow: 0 0 0 3px rgba(47, 129, 247, 0.3);
        }

        /* GitHub Styled Buttons */
        .btn {
            background-color: #21262d;
            border: 1px solid var(--color-border-default);
            border-radius: 6px;
            color: var(--color-fg-default);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            font-weight: 500;
            padding: 5px 16px;
            transition: .2s;
        }

        .btn:hover { background-color: #30363d; border-color: #8b949e; }

        .btn-primary {
            background-color: var(--color-btn-bg);
            border-color: rgba(240, 246, 252, 0.1);
            color: #fff;
        }

        .btn-primary:hover { background-color: var(--color-btn-hover); }

        .btn-sm { padding: 3px 12px; font-size: 12px; }

        /* File Gallery List */
        .file-list {
            border: 1px solid var(--color-border-default);
            border-radius: 6px;
            background-color: var(--color-canvas-default);
        }

        .file-list-header {
            background-color: var(--color-canvas-subtle);
            padding: 12px 16px;
            border-bottom: 1px solid var(--color-border-default);
            display: flex;
            font-size: 14px;
            color: var(--color-fg-muted);
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid var(--color-border-default);
            transition: background 0.1s;
        }

        .file-item:last-child { border-bottom: none; }
        .file-item:hover { background-color: #161b22; }

        .preview-img {
            width: 32px;
            height: 32px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 15px;
            border: 1px solid var(--color-border-default);
        }

        /* Search Filter Bar */
        .filter-bar {
            background-color: var(--color-canvas-subtle);
            border: 1px solid var(--color-border-default);
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
        }

        /* Toast Message */
        #toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 12px 24px;
            border-radius: 6px;
            background-color: #388bfd;
            border-left: 4px solid #fff;
            color: white;
            font-weight: 600;
            display: none;
            z-index: 100;
            box-shadow: 0 8px 24px rgba(0,0,0,0.5);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        .toast-error { background-color: #f85149 !important; border-left-color: #ffdce0; }

    </style>
</head>
<body>

<nav>
    <div class="nav-left">
        <svg height="32" viewBox="0 0 16 16" version="1.1" width="32" fill="white"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path></svg>
        <strong style="font-size: 14px;">GitHub Image Cloud</strong>
    </div>
    <div class="btn-sm btn">Sign Out</div>
</nav>

<div class="container">
    <div class="repo-header">
        <div class="repo-path">
            <svg color="gray" viewBox="0 0 16 16" fill="currentColor" width="18" height="18"><path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7l.01.01 2.217 2.217a.75.75 0 0 1-1.06 1.06L1.508 13.09A2.5 2.5 0 0 1 2 8.5V2.5Z"></path></svg>
            <a href="#">CloudStorage</a> <span>/</span> <a href="#" id="repoNameDisplay">Repository</a>
            <span class="repo-badge">Public</span>
        </div>
        <div style="display: flex; gap: 8px;">
            <div class="btn btn-sm">Star <span>12</span></div>
            <div class="btn btn-sm">Fork <span>5</span></div>
        </div>
    </div>

    <div class="tabs">
        <a href="#" class="tab active">Code</a>
        <a href="#" class="tab">Issues</a>
        <a href="#" class="tab">Pull requests</a>
        <a href="#" class="tab">Actions</a>
    </div>

    <div class="box">
        <div class="box-header">
            <span>Authentication Settings</span>
            <span style="font-size: 11px; color: var(--color-fg-muted);">Expires: 90 Days</span>
        </div>
        <div class="box-body">
            <div class="input-row">
                <input type="password" id="token" placeholder="Personal Access Token (classic)">
                <input type="text" id="repo" placeholder="username/repository">
            </div>
            <input type="text" id="folder" value="images" placeholder="Folder path">
        </div>
    </div>

    <div class="filter-bar">
        <div style="flex-grow: 1; display: flex; align-items: center; gap: 10px;">
            <input type="file" id="fileInput" accept="image/*" style="font-size: 12px; max-width: 200px;">
            <button class="btn btn-primary btn-sm" onclick="uploadImage()">Add file</button>
        </div>
        <button class="btn btn-sm" onclick="fetchImages()">Sync Refresh</button>
    </div>

    <div class="file-list" id="fileList">
        <div class="file-list-header">
            <span style="flex-grow: 1;">Name</span>
            <span style="width: 100px;">Size</span>
            <span style="width: 150px; text-align: right;">Options</span>
        </div>
        <div style="padding: 48px; text-align: center; color: var(--color-fg-muted);">
            No assets detected in the cloud repository.
        </div>
    </div>
</div>

<div id="toast"></div>

<script>
    const toast = document.getElementById('toast');
    const fileList = document.getElementById('fileList');

    function showToast(msg, isError = false) {
        toast.innerText = msg;
        toast.className = isError ? 'toast-error' : '';
        toast.style.display = 'block';
        setTimeout(() => toast.style.display = 'none', 4000);
    }

    async function uploadImage() {
        const fileInput = document.getElementById('fileInput');
        const token = document.getElementById('token').value;
        const repo = document.getElementById('repo').value;
        const folder = document.getElementById('folder').value;

        if (!fileInput.files[0] || !token) return showToast("Credentials missing", true);

        const file = fileInput.files[0];
        const reader = new FileReader();
        
        showToast("Committing changes...");

        reader.onload = async () => {
            const base64Content = reader.result.split(',')[1];
            const url = `https://api.github.com/repos/${repo}/contents/${folder}/${file.name}`;

            try {
                let sha = null;
                const check = await fetch(url, { headers: { 'Authorization': `token ${token}` } });
                if (check.ok) {
                    const data = await check.json();
                    sha = data.sha;
                }

                const res = await fetch(url, {
                    method: 'PUT',
                    headers: { 'Authorization': `token ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: `Upload image: ${file.name}`, content: base64Content, sha: sha })
                });

                if (res.ok) {
                    showToast("Successfully committed to branch");
                    fetchImages();
                } else { throw new Error("API Transmission Error"); }
            } catch (e) { showToast(e.message, true); }
        };
        reader.readAsDataURL(file);
    }

    async function fetchImages() {
        const token = document.getElementById('token').value;
        const repo = document.getElementById('repo').value;
        const folder = document.getElementById('folder').value;
        
        if (!token || !repo) return showToast("Config required", true);
        document.getElementById('repoNameDisplay').innerText = repo;

        try {
            const res = await fetch(`https://api.github.com/repos/${repo}/contents/${folder}`, {
                headers: { 'Authorization': `token ${token}` }
            });
            if (!res.ok) throw new Error("Path not found in repository");
            const files = await res.json();
            
            // Rebuild the list with the new UI headers
            fileList.innerHTML = `<div class="file-list-header"><span style="flex-grow: 1;">Name</span><span style="width: 100px;">Size</span><span style="width: 150px; text-align: right;">Options</span></div>`;
            
            files.forEach(f => {
                if (/\.(jpe?g|png|gif|webp)$/i.test(f.name)) {
                    const row = document.createElement('div');
                    row.className = 'file-item';
                    row.innerHTML = `
                        <img class="preview-img" src="${f.download_url}">
                        <div style="flex-grow: 1;">
                            <div style="color: var(--color-accent-fg); font-weight: 500; font-size: 14px; cursor: pointer;">${f.name}</div>
                        </div>
                        <div style="width: 100px; font-size: 12px; color: var(--color-fg-muted);">${(f.size / 1024).toFixed(1)} KB</div>
                        <div style="width: 150px; text-align: right;">
                             <a href="${f.download_url}" target="_blank" class="btn btn-sm">Raw</a>
                             <button class="btn btn-sm" onclick="navigator.clipboard.writeText('${f.download_url}'); showToast('URL Copied');">Link</button>
                        </div>
                    `;
                    fileList.appendChild(row);
                }
            });
            showToast("Sync complete");
        } catch (e) { showToast(e.message, true); }
    }
</script>
</body>
</html>
